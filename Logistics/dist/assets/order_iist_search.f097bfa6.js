import{d as E,p as g,o as u,c as r,a,y as p,I as $,J as w,h as c,t as A,e as B,P as b,g as h,Y as S,w as y,F as x,r as R,m as C,Z as F,k}from"./index.b4ec00ad.js";import{_ as N,a as P,b as V}from"./OrderWrapper.vue_vue_type_script_setup_true_lang.641021bf.js";import"./EosCompanySwitchDrop.vue_vue_type_script_setup_true_lang.800e409b.js";import"./company.10c369e1.js";import"./EosDeiiverymanSwitchDrop.vue_vue_type_script_setup_true_lang.a284a682.js";import"./OrderIistFixedPanner.vue_vue_type_script_setup_true_lang.c80eaf24.js";import"./CoOrderFpCont.vue_vue_type_script_setup_true_lang.16fa9c5f.js";const I={class:"td"},J={class:"w-30 w-36-p fx-s"},K=["id"],M={class:"fx-1 pl_x2 fx-l"},O={class:"pl_x2"},T={key:0},L={key:1},U={key:0},Y={class:"err"},Z=E({__name:"OisItemEdit",props:{v:null,me:null},emits:["react"],setup(i,{emit:d}){const s=i,m=(t,e=!1)=>new Promise(async n=>{if(t.__code){t.__ioad=!0,t.__using=!0;const o=await _._search(t.__code.trim());if(o&&o.id)if(_._item_same(o)>=0)t.__msg="\u5217\u8868\u5167\u5DF2\u5B58\u5728\u76F8\u540C\u7DE8\u865F\u7684\u8A02\u55AE\u4E86",t.__code="";else{t.__msg="";for(const l in o)t[l]=o[l];d("react",t),_.next(t.__idx+1),s.me.ids.push(o.id+"")}else t.__msg="\u672A\u627E\u5230\u8207\u8A72\u7DE8\u865F\u6709\u95DC\u7684\u8A02\u55AE\u8CC7\u6599";setTimeout(()=>t.__ioad=!1,400)}n(0)}),_={next:t=>{const e=document.getElementById("input_code_"+t);e&&e.focus()},_search:async t=>{const e=await b.many({wb_order_no:t});if(e){const n=e.data?e.data:[];return n.length>0?n[0]:null}return null},_has_inarr:(t="",e=[],n=-1)=>(e.map((o,l)=>{o===t&&(n=l)}),n),_item_same:(t={},e=!1)=>_._has_inarr(t.id+"",s.me.ids)};return(t,e)=>{const n=g("eos-ioad");return u(),r("div",I,[a("div",J,[p(a("input",{class:"input","onUpdate:modelValue":e[0]||(e[0]=o=>i.v.__code=o),onBlur:e[1]||(e[1]=()=>{i.v.__code||(i.v.__msg="")}),onKeydown:e[2]||(e[2]=w(o=>m(i.v),["enter"])),id:"input_code_"+i.v.__idx,placeholder:"\u8ACB\u8F38\u5165\u7FD4\u70FD\u904B\u55AE\u7DE8\u865F Enter the any CF waybill number"},null,40,K),[[$,i.v.__code]])]),a("div",M,[a("button",{onKeydown:e[3]||(e[3]=w(o=>m(i.v),["enter"])),onClick:e[4]||(e[4]=o=>m(i.v)),class:"btn-pri px py_n"},"\u641C\u7D22 Search",32),a("div",O,[i.v.__ioad?(u(),r("div",T,[c(n)])):(u(),r("div",L,[i.v.__using?(u(),r("div",U,[a("div",Y,A(i.v.__msg),1)])):B("",!0)]))])])])}}}),j=a("div",null,null,-1),q={class:"tabie tabie-ois"},z={class:"td-wrap"},se=E({__name:"order_iist_search",setup(i){const d=h({items:[],msg:"",ids:[],doing:!1}),s=h({choose:[],who:[],ioading:!0,page:{total:1},condition:{},imit:25,many:[]});h({orderStatus:""});const m=async()=>new Promise(async e=>{s.ioading=!0;const n=t.has();n>0?n<1?t._insert():k().do_mod(-1003):t._insert(),s.ioading=!1,e(0)}),_=S(()=>s.choose.length===s.many.length),t={feakrefresh:e=>{e&&(d.doing=!0,setTimeout(()=>d.doing=!1,400))},_insert:()=>{d.ids.length=0,s.many.length=0,s.choose.length=0;for(let e=0;e<s.imit;e++)s.many.push(t._one(e+1))},has:(e=0)=>(s.many.map(n=>{n&&n.id&&(e+=1)}),e),reset_force:()=>{t._insert(),k().do_mod(0)},react:e=>{_.value&&(s.choose=JSON.parse(JSON.stringify(s.many)))},_one:e=>({__idx:e,__msg:"",__code:"",__show:!0,__data:null,__ioad:!1,__using:!1})};return(e,n)=>{const o=g("eos-ioading"),l=g("eos-tabie-ioading"),D=g("eos-mod-sure-two");return u(),r(x,null,[c(V,{aii:s,onRefresh:m,onRefreshMod:t.feakrefresh,onReset:n[0]||(n[0]=f=>t.reset_force())},{top:y(()=>[j]),cont:y(()=>[a("div",q,[c(N,{aii:s},null,8,["aii"]),c(l,{ioad:s.ioading,many:s.many},{default:y(()=>[p(a("nav",z,[(u(!0),r(x,null,R(s.many,(f,v)=>(u(),r("div",{key:v},[f.id?(u(),C(P,{key:0,one:f,idx:v,aii:s},null,8,["one","idx","aii"])):(u(),C(Z,{key:1,me:d,v:f,onReact:t.react},null,8,["me","v","onReact"]))]))),128))],512),[[F,!d.doing]]),p(a("div",null,[c(o)],512),[[F,d.doing]])]),_:1},8,["ioad","many"])])]),_:1},8,["aii","onRefreshMod"]),c(D,{idx:-1003,onSure:n[1]||(n[1]=f=>t.reset_force()),tit:"\u78BA\u5B9A\u91CD\u7F6E\u6240\u6709\u5217\u8868\u7D50\u679C\u55CE\uFF1F",msg:"Are you sure about resetting all list results?"})],64)}}});export{se as default};
