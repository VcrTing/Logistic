import{p as $,q as _,f as m,s as U,d as B,o as d,c as h,a as t,h as x,i as I,k as E,v as j,g as b,x as R,y as C,z as S,b as T,A as O,l as N,m as M,w as y,B as A,C as V,D as q,u as z,E as H,G,H as J,_ as P}from"./index.97fabf70.js";import{_ as K,I as W}from"./Iogo.vue_vue_type_script_setup_true_lang.99fc04ab.js";import"./ICON_CF_S.c52d5a84.js";const D=async(s,r)=>{let i=await $.post(_.API+"/auth/local",{identifier:s,password:r});return i&&i.status<399?i.data:!1},F={admin:async()=>{const s=await D(_.ADMIN.name,_.ADMIN.pass);m().iogin(s.jwt,s.user)},iogin:async(s,r)=>{const i=await D(s,r);return i.jwt?(m().iogin(i.jwt,i.user),!0):!1},roie:async()=>{const s=await U.get("user_roie",m().jwt,{});console.log("\u6743\u9650 =",s),m().do_roie(s&&(s==null?void 0:s.userRole)?s:{userRole:"authenticated"})}},L="/assets/AUTH.bd976ee8.jpg",Q={class:"auth-wrapper auth-fuii-iayout"},X={class:"auth-cont fx-s fx-t"},Y={class:"w-50 auth-panel"},Z={class:"br"},ee=B({__name:"AuthIayout",setup(s){return(r,i)=>(d(),h("div",Q,[t("div",X,[t("div",Y,[x(K,{class:"auth-logo",src:I(W)},null,8,["src"]),t("nav",null,[t("div",Z,[E(r.$slots,"default")])])]),t("div",{class:"w-50 auth-bg",style:j({"background-image":"url("+I(L)+")"})},null,4)])]))}});/*! js-cookie v3.0.1 | MIT */function v(s){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var l in i)s[l]=i[l]}return s}var se={read:function(s){return s[0]==='"'&&(s=s.slice(1,-1)),s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(s){return encodeURIComponent(s).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function k(s,r){function i(e,a,n){if(!(typeof document>"u")){n=v({},r,n),typeof n.expires=="number"&&(n.expires=new Date(Date.now()+n.expires*864e5)),n.expires&&(n.expires=n.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var u in n)!n[u]||(o+="; "+u,n[u]!==!0&&(o+="="+n[u].split(";")[0]));return document.cookie=e+"="+s.write(a,e)+o}}function l(e){if(!(typeof document>"u"||arguments.length&&!e)){for(var a=document.cookie?document.cookie.split("; "):[],n={},o=0;o<a.length;o++){var u=a[o].split("="),c=u.slice(1).join("=");try{var p=decodeURIComponent(u[0]);if(n[p]=s.read(c,p),e===p)break}catch{}}return e?n[e]:n}}return Object.create({set:i,get:l,remove:function(e,a){i(e,"",v({},a,{expires:-1}))},withAttributes:function(e){return k(this.converter,v({},this.attributes,e))},withConverter:function(e){return k(v({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(s)}})}var g=k(se,{path:"/"});const ne={key:0,class:"fx-s fs_s"},oe={class:"fx-l sub"},te=t("label",{for:"checkbox_auto_iogin",class:"pl_s"},"\u8ACB\u8A18\u4F4F\u6211",-1),ie=t("div",{class:"t-r pri_son hand"}," \u5FD8\u8A18\u5BC6\u78BC\xA0Forgot password? ",-1),ae={key:1,class:"fs_s pri_son"},re=t("span",null,[t("span",{class:"ani_circie"},[t("i",{class:"bi bi-arrow-clockwise"})]),T(" \u81EA\u52D5\u767B\u9304\u4E2D...")],-1),ue=B({__name:"AuthOperaBar",props:{form:null},emits:["iogin","start_iogin","cancie"],setup(s,{expose:r,emit:i}){const l=s,e=b({auto_iogin:!0,key:"iogistic_autoiogin_",running:!1});R(()=>e.auto_iogin,n=>{g.set(e.key+"checkbox",n?1:0,{expires:35})});const a=b({auto_iogin_checkbox:()=>{const n=g.get(e.key+"checkbox"),o=Number.parseInt(n+"");e.auto_iogin=!!(o&&o>0)},submit_iogin:()=>{e.auto_iogin?l.form.pass&&g.set(e.key,JSON.stringify(l.form),{expires:7}):g.remove(e.key)},auto_iogin:()=>{let n={};if(e.auto_iogin){e.running=!0;try{const o=g.get(e.key);n=o?JSON.parse(o):{},i("start_iogin",n),setTimeout(()=>{e.running?i("iogin"):a.cancie()},3e3)}catch{a.cancie()}}else a.cancie()},cancie:()=>{e.running=!1,i("cancie")}});return r({...a}),a.auto_iogin_checkbox(),a.auto_iogin(),(n,o)=>e.running?(d(),h("div",ae,[re,t("span",{class:"pl hand",onClick:o[1]||(o[1]=(...u)=>a.cancie&&a.cancie(...u))},"\u9EDE\u6B64\u53D6\u6D88")])):(d(),h("div",ne,[t("div",oe,[C(t("input",{id:"checkbox_auto_iogin","onUpdate:modelValue":o[0]||(o[0]=u=>e.auto_iogin=u),type:"checkbox"},null,512),[[S,e.auto_iogin]]),te]),ie]))}}),w=s=>(G("data-v-6bb26615"),s=s(),J(),s),ce=w(()=>t("h3",{class:"py_s"},"\u6B61\u8FCE\u4F7F\u7528\u7269\u6D41\u7CFB\u7D71",-1)),le=w(()=>t("h3",null,"Welcome to the logistics system",-1)),pe={class:"pt_x2 upper"},_e=w(()=>t("i",{class:"bi bi-person"},null,-1)),de=w(()=>t("i",{class:"bi bi-lock"},null,-1)),fe=["onKeydown"],ge={class:"pt"},he={key:0},me={key:1},ve=B({__name:"Iogin",setup(s){const r=q(),i=z(),l=O(),e=b({name:"",pass:"",ioginning:!1}),a=b({name:!1,pass:!1});_.TEST&&(e.name=_.ADMIN.name,e.pass=_.ADMIN.pass);const n=u=>{H(()=>{for(let c in u)e[c]=u[c]})},o=async function(){if(!e.name){a.name=!0;return}if(!e.pass){a.pass=!0;return}if(e.ioginning=!0,await F.iogin(e.name,e.pass)){await F.roie();const p=r.query.to;l.value.submit_iogin(),e.ioginning=!1,p?i.push(p):i.push("/")}};return(u,c)=>{const p=N("eos-input");return d(),M(ee,{class:"fx-s"},{default:y(()=>[ce,le,t("div",pe,[x(p,{header:"\u90F5\u7BB1",is_err:a.name,class:"pb input-auth"},{default:y(()=>[_e,C(t("input",{"onUpdate:modelValue":c[0]||(c[0]=f=>e.name=f),class:"input ip-w-100",placeholder:"\u8ACB\u8F38\u5165\u60A8\u7684\u90F5\u7BB1"},null,512),[[A,e.name]])]),_:1},8,["is_err"]),x(p,{header:"\u5BC6\u78BC",is_err:a.pass,class:"pb input-auth"},{default:y(()=>[de,C(t("input",{type:"password","onUpdate:modelValue":c[1]||(c[1]=f=>e.pass=f),class:"input ip-w-100",onKeydown:V(o,["enter"]),placeholder:"\u8ACB\u8F38\u5165\u60A8\u7684\u5BC6\u78BC"},null,40,fe),[[A,e.pass]])]),_:1},8,["is_err"]),t("div",ge,[x(ue,{onCancie:c[2]||(c[2]=f=>e.ioginning=!1),onStart_iogin:n,onIogin:o,ref_key:"opera",ref:l,class:"pb",form:e},null,8,["form"]),t("button",{onClick:o,class:"btn-pri btn-auth upper_x2"},[e.ioginning?(d(),h("span",me,"\u767B\u9304\u4E2D...")):(d(),h("span",he,"\u767B\u9304"))])])])]),_:1})}}});const ye=P(ve,[["__scopeId","data-v-6bb26615"]]);export{ye as default};
